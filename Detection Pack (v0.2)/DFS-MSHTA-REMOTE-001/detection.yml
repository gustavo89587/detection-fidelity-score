title: mshta Remote Script Execution
id: DFS-MSHTA-REMOTE-001
status: test
description: Detects mshta.exe executing remote or inline script content.
author: gustavo

logsource:
  product: windows
  category: process_creation

detection:
  selection:
    Image|endswith: '\mshta.exe'
    CommandLine|contains:
      - 'http://'
      - 'https://'
      - 'javascript:'
      - 'vbscript:'
  filter_system:
    User|startswith:
      - 'NT AUTHORITY'
      - 'SYSTEM'
  condition: selection and not filter_system

falsepositives:
  - Rare legitimate HTA-based enterprise tools

level: high
tags:
  - attack.execution
  - attack.t1218.005
